import React from 'react';
import { mount } from 'enzyme';
import Root from 'Root';
import Home from 'components/pages/Home';
import moxios from 'moxios';

let wrapped;

beforeEach(() => {
    wrapped = mount(
        <Root>
            <Home />
        </Root>
    )
    moxios.install();
    moxios.stubRequest('https://api.themoviedb.org/3/search/movie?api_key=5263cfe7d7523c72560af41d11d438d7&language=en-US&query=Harry&page=1&include_adult=false',
        {
            "page": 1, "total_results": 428, "total_pages": 22, "results": [{ "popularity": 26.263, "vote_count": 2496, "video": false, "poster_path": "\/y91dTeB7EMG0DHkjBR9O3M0vJuk.jpg", "id": 639, "adult": false, "backdrop_path": "\/xd5SYDUhNVGLUeK2epbEjnVBpPN.jpg", "original_language": "en", "original_title": "When Harry Met Sally...", "genre_ids": [35, 18, 10749], "title": "When Harry Met Sally...", "vote_average": 7.4, "overview": "During their travel from Chicago to New York, Harry and Sally debate whether or not sex ruins a friendship between a man and a woman. Eleven years later, and they're still no closer to finding the answer.", "release_date": "1989-01-12" }, { "popularity": 47.73, "vote_count": 17488, "video": false, "poster_path": "\/wuMc08IPKEatf9rnMNXvIDxqP4W.jpg", "id": 671, "adult": false, "backdrop_path": "\/hziiv14OpD73u9gAak4XDDfBKa2.jpg", "original_language": "en", "original_title": "Harry Potter and the Philosopher's Stone", "genre_ids": [12, 14, 10751], "title": "Harry Potter and the Philosopher's Stone", "vote_average": 7.9, "overview": "Harry Potter has lived under the stairs at his aunt and uncle's house his whole life. But on his 11th birthday, he learns he's a powerful wizard -- with a place waiting for him at the Hogwarts School of Witchcraft and Wizardry. As he learns to harness his newfound powers with the help of the school's kindly headmaster, Harry uncovers the truth about his parents' deaths -- and about the villain who's to blame.", "release_date": "2001-11-16" }, { "popularity": 12.295, "vote_count": 600, "video": false, "poster_path": "\/zthprdjuK7vN4ABBGQXo8RF7qYB.jpg", "id": 25941, "adult": false, "backdrop_path": "\/AhmRmdlu7GYdiucfZzVCGyP8ICf.jpg", "original_language": "en", "original_title": "Harry Brown", "genre_ids": [28, 80, 18, 53], "title": "Harry Brown", "vote_average": 6.8, "overview": "An elderly ex-serviceman and widower looks to avenge his best friend's murder by doling out his own form of justice.", "release_date": "2009-11-11" }, { "popularity": 15.636, "id": 984, "video": false, "vote_count": 1346, "vote_average": 7.5, "title": "Dirty Harry", "release_date": "1971-07-14", "original_language": "en", "original_title": "Dirty Harry", "genre_ids": [28, 80, 53], "backdrop_path": "\/5kex1QQCRjNFKbsaFLaX4j3IDKa.jpg", "adult": false, "overview": "When a madman dubbed 'Scorpio' terrorizes San Francisco, hard-nosed cop, Harry Callahan – famous for his take-no-prisoners approach to law enforcement – is tasked with hunting down the psychopath. Harry eventually collars Scorpio in the process of rescuing a kidnap victim, only to see him walk on technicalities. Now, the maverick detective is determined to nail the maniac himself.", "poster_path": "\/UHxxkYe9tRdiPu0JFgcEL5hmQ4.jpg" }, { "popularity": 41.834, "vote_count": 12916, "video": false, "poster_path": "\/Ag21otqbeynZPGjEbzyr3X5Us0j.jpg", "id": 767, "adult": false, "backdrop_path": "\/kT8bDEAgEYBKhRJtqM97qTw6uRW.jpg", "original_language": "en", "original_title": "Harry Potter and the Half-Blood Prince", "genre_ids": [12, 14], "title": "Harry Potter and the Half-Blood Prince", "vote_average": 7.7, "overview": "As Harry begins his sixth year at Hogwarts, he discovers an old book marked as 'Property of the Half-Blood Prince', and begins to learn more about Lord Voldemort's dark past.", "release_date": "2009-07-07" }, { "popularity": 42.147, "vote_count": 14570, "video": false, "poster_path": "\/sdEOH0992YZ0QSxgXNIGLq1ToUi.jpg", "id": 672, "adult": false, "backdrop_path": "\/bvRnPaai6JL7XHF4K6414DdSHro.jpg", "original_language": "en", "original_title": "Harry Potter and the Chamber of Secrets", "genre_ids": [12, 14], "title": "Harry Potter and the Chamber of Secrets", "vote_average": 7.7, "overview": "Cars fly, trees fight back, and a mysterious house-elf comes to warn Harry Potter at the start of his second year at Hogwarts. Adventure and danger await when bloody writing on a wall announces: The Chamber Of Secrets Has Been Opened. To save Hogwarts will require all of Harry, Ron and Hermione’s magical abilities and courage.", "release_date": "2002-11-13" }, { "popularity": 12.913, "id": 2639, "video": false, "vote_count": 453, "vote_average": 7.4, "title": "Deconstructing Harry", "release_date": "1997-12-12", "original_language": "en", "original_title": "Deconstructing Harry", "genre_ids": [35, 18], "backdrop_path": "\/coJLkvK5KZQoMl8vGqcpgAZYroi.jpg", "adult": false, "overview": "This film tells the story of a successful writer called Harry Block, played by Allen himself, who draws inspiration from people he knows in real-life, and from events that happened to him, sometimes causing these people to become alienated from him as a result.", "poster_path": "\/2ZkTBt5wunAIIEx6UFtxxLdzkKM.jpg" }, { "popularity": 35.385, "vote_count": 13609, "video": false, "poster_path": "\/fECBtHlr0RB3foNHDiCBXeg9Bv9.jpg", "id": 674, "adult": false, "backdrop_path": "\/8f9dnOtpArDrOMEylpSN9Sc6fuz.jpg", "original_language": "en", "original_title": "Harry Potter and the Goblet of Fire", "genre_ids": [12, 14, 10751], "title": "Harry Potter and the Goblet of Fire", "vote_average": 7.8, "overview": "Harry starts his fourth year at Hogwarts, competes in the treacherous Triwizard Tournament and faces the evil Lord Voldemort. Ron and Hermione help Harry manage the pressure – but Voldemort lurks, awaiting his chance to destroy Harry and all that he stands for.", "release_date": "2005-11-16" }, { "popularity": 35.789, "vote_count": 14211, "video": false, "poster_path": "\/uDQibffYgssdiqx7izO57wdLc6.jpg", "id": 673, "adult": false, "backdrop_path": "\/vbk5CfaAHOjQPSAcYm6AoRRz2Af.jpg", "original_language": "en", "original_title": "Harry Potter and the Prisoner of Azkaban", "genre_ids": [12, 14], "title": "Harry Potter and the Prisoner of Azkaban", "vote_average": 8, "overview": "Harry, Ron and Hermione return to Hogwarts for another magic-filled year. Harry comes face to face with danger yet again, this time in the form of escaped convict, Sirius Black—and turns to sympathetic Professor Lupin for help.", "release_date": "2004-05-31" }, { "popularity": 37.462, "vote_count": 13213, "video": false, "poster_path": "\/g6n8G0xPnBVUIKKK41sNmbZB5h4.jpg", "id": 675, "adult": false, "backdrop_path": "\/pkxPkHOPJjOvzfQOclANEBT8OfK.jpg", "original_language": "en", "original_title": "Harry Potter and the Order of the Phoenix", "genre_ids": [12, 14, 9648], "title": "Harry Potter and the Order of the Phoenix", "vote_average": 7.7, "overview": "Returning for his fifth year of study at Hogwarts, Harry is stunned to find that his warnings about the return of Lord Voldemort have been ignored. Left with no choice, Harry takes matters into his own hands, training a small group of students – dubbed 'Dumbledore's Army' – to defend themselves against the dark arts.", "release_date": "2007-06-28" }, { "popularity": 37.947, "vote_count": 14031, "video": false, "poster_path": "\/da22ZBmrDOXOCDRvr8Gic8ldhv4.jpg", "id": 12445, "adult": false, "backdrop_path": "\/n5A7brJCjejceZmHyujwUTVgQNC.jpg", "original_language": "en", "original_title": "Harry Potter and the Deathly Hallows: Part 2", "genre_ids": [12, 14], "title": "Harry Potter and the Deathly Hallows: Part 2", "vote_average": 8.1, "overview": "Harry, Ron and Hermione continue their quest to vanquish the evil Voldemort once and for all. Just as things begin to look hopeless for the young wizards, Harry discovers a trio of magical objects that endow him with powers to rival Voldemort's formidable skills.", "release_date": "2011-07-07" }, { "popularity": 36.64, "vote_count": 13059, "video": false, "poster_path": "\/iGoXIpQb7Pot00EEdwpwPajheZ5.jpg", "id": 12444, "adult": false, "backdrop_path": "\/fXRXpzxUApE3OuXhIqsdavQjCVa.jpg", "original_language": "en", "original_title": "Harry Potter and the Deathly Hallows: Part 1", "genre_ids": [12, 14], "title": "Harry Potter and the Deathly Hallows: Part 1", "vote_average": 7.8, "overview": "Harry, Ron and Hermione walk away from their last year at Hogwarts to find and destroy the remaining Horcruxes, putting an end to Voldemort's bid for immortality. But with Harry's beloved Dumbledore dead and Voldemort's unscrupulous Death Eaters on the loose, the world is more dangerous than ever.", "release_date": "2010-10-17" }, { "popularity": 9.161, "vote_count": 160, "video": false, "poster_path": "\/qf7LNguEfBHF9WRs9sKGPBaQYEt.jpg", "id": 11718, "adult": false, "backdrop_path": "\/hNQ0R4wSaXTUPUQti8FtKLf1HQ6.jpg", "original_language": "en", "original_title": "Who's Harry Crumb?", "genre_ids": [35, 80, 9648], "title": "Who's Harry Crumb?", "vote_average": 5.6, "overview": "Harry Crumb is a bumbling and inept private investigator who is hired to solve the kidnapping of a young heiress which he's not expected to solve because his employer is the mastermind behind the kidnapping.", "release_date": "1989-02-03" }, { "popularity": 11.377, "vote_count": 387, "video": false, "poster_path": "\/reHlE6G4P1Tsd75REdD1ruhpKnm.jpg", "id": 8989, "adult": false, "backdrop_path": "\/71gHxSX2Tzg9mi1VYRdwCECfmpj.jpg", "original_language": "en", "original_title": "Harry and the Hendersons", "genre_ids": [35, 14, 10751], "title": "Harry and the Hendersons", "vote_average": 5.8, "overview": "Returning from a hunting trip in the forest, the Henderson family's car hits an animal in the road. At first they fear it was a man, but when they examine the \"body\" they find it's a \"bigfoot\". They think it's dead so they decide to take it home (there could be some money in this). As you guessed, it isn't dead. Far from being the ferocious monster they fear \"Harry\" to be, he's a friendly giant.", "release_date": "1987-06-05" }, { "popularity": 6.981, "vote_count": 30, "video": false, "poster_path": "\/kl9yUlWRBEyXNGIXav1WIRBy5te.jpg", "id": 91767, "adult": false, "backdrop_path": "\/4PHbeHC7q7XJk44TsbAUwDS2rv1.jpg", "original_language": "en", "original_title": "Harry & Son", "genre_ids": [18], "title": "Harry & Son", "vote_average": 5.8, "overview": "Widower Harry Keach is a construction worker who was raised to appreciate the importance of working for a living. He takes a dim view of his sensitive son Howard's lackadaisical lifestyle and has a strained relationship with his daughter Nina as he does not approve of her husband. When Harry is fired from his job, his life changes drastically as he is made to focus on the relationships around him.", "release_date": "1984-03-02" }, { "popularity": 12.015, "id": 11219, "video": false, "vote_count": 417, "vote_average": 7, "title": "The Trouble with Harry", "release_date": "1955-10-03", "original_language": "en", "original_title": "The Trouble with Harry", "genre_ids": [35, 80, 9648], "backdrop_path": "\/kqNOguuCc9fQuWrzv3LE6L1I4J1.jpg", "adult": false, "overview": "Trouble erupts in a small, quiet New England town when a man's body is found in the woods. The problem is that almost everyone in town thinks that they had something to do with his death.", "poster_path": "\/uUXLq7fEG3hI46ZFMZzgHj11S6S.jpg" }, { "popularity": 5.601, "vote_count": 13, "video": false, "poster_path": "\/psZ17QLU62Wfm1wD5j3ZvEO0wqT.jpg", "id": 27091, "adult": false, "backdrop_path": "\/kagW7NjLnnWzF7BFX8CfNUobQWM.jpg", "original_language": "en", "original_title": "Harry + Max", "genre_ids": [18, 10749], "title": "Harry + Max", "vote_average": 5.4, "overview": "Two brothers, 23 and 16, who are both teen idols, come to terms with their dysfunctional family past and deep affection for each other.", "release_date": "2004-01-17" }, { "popularity": 5.183, "id": 51933, "video": false, "vote_count": 10, "vote_average": 5.6, "title": "Handsome Harry", "release_date": "2009-04-25", "original_language": "en", "original_title": "Handsome Harry", "genre_ids": [80, 18], "backdrop_path": null, "adult": false, "overview": "An ex-Navy man carrying out the last wish of a dying shipmate renews contact with old friends to break the code of silence around a mysterious, long-buried crime.", "poster_path": "\/zf1mCsIvUm0aDBTeRwpnmXqE4pu.jpg" }, { "popularity": 4.586, "vote_count": 43, "video": false, "poster_path": "\/5aCrpRRJJBPZ0QqNuMmW2Rzp9FQ.jpg", "id": 42448, "adult": false, "backdrop_path": "\/sUOP9zEz55uPggkxp1IGhGEbjt.jpg", "original_language": "en", "original_title": "Harry and Tonto", "genre_ids": [35, 18], "title": "Harry and Tonto", "vote_average": 7.2, "overview": "Harry is a retired teacher in his 70s living in the Upper West Side of New York City where his late wife and he raised his children--where he's lived all his life. When the building he lives in is torn down to make way for a parking garage, Harry and his beloved cat Tonto begin a journey across the United States, visiting his children, seeing a world he never seemed to have the time to see before, making new friends, and saying goodbye to old friends.", "release_date": "1974-08-12" }, { "popularity": 9.378, "vote_count": 132, "video": false, "poster_path": "\/2ODzSaM8EKF28mGjNTH3ptb3BJu.jpg", "id": 518527, "adult": false, "backdrop_path": "\/bDqchWjPhko0XvRBx4pErPMk0Hv.jpg", "original_language": "en", "original_title": "Harry & Meghan: A Royal Romance", "genre_ids": [10749], "title": "Harry & Meghan: A Royal Romance", "vote_average": 6.8, "overview": "Examine the history of Prince Harry and Meghan Markle from the moment they met after being set up by friends, through their initial courtship when they were able to keep their romance under wraps, and ultimately the intense global media attention surrounding their relationship and Meghan’s life as a divorced American actress.", "release_date": "2018-05-13" }]
        });

});


afterEach(() => {
    wrapped.unmount();
    moxios.uninstall();
})


it('content created', () => {
    expect(wrapped.find('.movieListContainer').length).toEqual(1);
});


describe("funcinality test", () => {
    beforeEach(() => {
        wrapped.find('.searchInput').simulate('change', {
            target: { value: 'Harry' }
        });

        wrapped.update();
    });

    it('has an input that users cant type in', () => {
        expect(wrapped.find('.searchInput').prop('value')).toEqual('Harry');
    });

    describe('can search with the text', () => {

        it('Enter funcionality', (done) => {
            wrapped.find('.searchInput').simulate('keypress', { key: 'Enter' })

            moxios.wait(()=>{
                wrapped.update();
                done();
                expect(wrapped.find('.movieListContainer article').length).toEqual(21)
            });

        });

        it('Click on Icon funcionality', (done) => {
            wrapped.find('.scopeIcon').simulate('click')
            

            moxios.wait(()=>{
                wrapped.update();
                done();
                expect(wrapped.find('.movieListContainer article').length).toEqual(21)
            });
        });

    });

})